import{r as S,j as k}from"./react-CpblpCxn.js";import{L as se,T as $e,R as Ve,U as Xe,B as Ye,M as Ke,C as Je,a as Qe,O as Ze,P as et,S as be,b as ae,N as tt,A as nt,W as rt,c as ot,d as it,e as st,V as at,f as K,g as ct,h as lt,i as ut}from"./three-BAIG_oXH.js";import{c as ye}from"./debounce-BM9AhqEY.js";import{F as ft,u as dt}from"./its-fine-CLVdEtF8.js";import{R as pt,c as U}from"./react-reconciler-Clv10PUg.js";import{s as _e}from"./scheduler-BH9xjw3X.js";import"./react-dom-BW1VeLr9.js";import{_ as vt}from"./@babel-CF3RwP-h.js";import{O as mt}from"./three-stdlib-BNBAbWEg.js";import{s as ht,p as gt,c as wt}from"./suspend-react-BKIKQNXN.js";function bt(e){let t;const o=new Set,s=(m,n)=>{const r=typeof m=="function"?m(t):m;if(r!==t){const a=t;t=n?r:Object.assign({},t,r),o.forEach(p=>p(t,a))}},l=()=>t,d=(m,n=l,r=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let a=n(t);function p(){const h=n(t);if(!r(a,h)){const w=a;m(a=h,w)}}return o.add(p),()=>o.delete(p)},u={setState:s,getState:l,subscribe:(m,n,r)=>n||r?d(m,n,r):(o.add(m),()=>o.delete(m)),destroy:()=>o.clear()};return t=e(s,l,u),u}const yt=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Ee=yt?S.useEffect:S.useLayoutEffect;function _t(e){const t=typeof e=="function"?bt(e):e,o=(s=t.getState,l=Object.is)=>{const[,d]=S.useReducer(v=>v+1,0),g=t.getState(),c=S.useRef(g),u=S.useRef(s),m=S.useRef(l),n=S.useRef(!1),r=S.useRef();r.current===void 0&&(r.current=s(g));let a,p=!1;(c.current!==g||u.current!==s||m.current!==l||n.current)&&(a=s(g),p=!l(r.current,a)),Ee(()=>{p&&(r.current=a),c.current=g,u.current=s,m.current=l,n.current=!1});const h=S.useRef(g);Ee(()=>{const v=()=>{try{const f=t.getState(),b=u.current(f);m.current(r.current,b)||(c.current=f,r.current=b,d())}catch{n.current=!0,d()}},i=t.subscribe(v);return t.getState()!==h.current&&v(),i},[]);const w=p?a:r.current;return S.useDebugValue(w),w};return Object.assign(o,t),o[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[o,t];return{next(){const l=s.length<=0;return{value:s.shift(),done:l}}}},o}const we={},Et=e=>void Object.assign(we,e);function St(e,t){function o(n,{args:r=[],attach:a,...p},h){let w=`${n[0].toUpperCase()}${n.slice(1)}`,v;if(n==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const i=p.object;v=q(i,{type:n,root:h,attach:a,primitive:!0})}else{const i=we[w];if(!i)throw new Error(`R3F: ${w} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");v=q(new i(...r),{type:n,root:h,attach:a,memoizedProps:{args:r}})}return v.__r3f.attach===void 0&&(v instanceof Ye?v.__r3f.attach="geometry":v instanceof Ke&&(v.__r3f.attach="material")),w!=="inject"&&ue(v,p),v}function s(n,r){let a=!1;if(r){var p,h;(p=r.__r3f)!=null&&p.attach?le(n,r,r.__r3f.attach):r.isObject3D&&n.isObject3D&&(n.add(r),a=!0),a||(h=n.__r3f)==null||h.objects.push(r),r.__r3f||q(r,{}),r.__r3f.parent=n,ge(r),G(r)}}function l(n,r,a){let p=!1;if(r){var h,w;if((h=r.__r3f)!=null&&h.attach)le(n,r,r.__r3f.attach);else if(r.isObject3D&&n.isObject3D){r.parent=n,r.dispatchEvent({type:"added"}),n.dispatchEvent({type:"childadded",child:r});const v=n.children.filter(f=>f!==r),i=v.indexOf(a);n.children=[...v.slice(0,i),r,...v.slice(i)],p=!0}p||(w=n.__r3f)==null||w.objects.push(r),r.__r3f||q(r,{}),r.__r3f.parent=n,ge(r),G(r)}}function d(n,r,a=!1){n&&[...n].forEach(p=>g(r,p,a))}function g(n,r,a){if(r){var p,h,w;if(r.__r3f&&(r.__r3f.parent=null),(p=n.__r3f)!=null&&p.objects&&(n.__r3f.objects=n.__r3f.objects.filter(C=>C!==r)),(h=r.__r3f)!=null&&h.attach)Re(n,r,r.__r3f.attach);else if(r.isObject3D&&n.isObject3D){var v;n.remove(r),(v=r.__r3f)!=null&&v.root&&Tt(re(r),r)}const f=(w=r.__r3f)==null?void 0:w.primitive,b=!f&&(a===void 0?r.dispose!==null:a);if(!f){var i;d((i=r.__r3f)==null?void 0:i.objects,r,b),d(r.children,r,b)}if(delete r.__r3f,b&&r.dispose&&r.type!=="Scene"){const C=()=>{try{r.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?_e.unstable_scheduleCallback(_e.unstable_IdlePriority,C):C()}G(n)}}function c(n,r,a,p){var h;const w=(h=n.__r3f)==null?void 0:h.parent;if(!w)return;const v=o(r,a,n.__r3f.root);if(n.children){for(const i of n.children)i.__r3f&&s(v,i);n.children=n.children.filter(i=>!i.__r3f)}n.__r3f.objects.forEach(i=>s(v,i)),n.__r3f.objects=[],n.__r3f.autoRemovedBeforeAppend||g(w,n),v.parent&&(v.__r3f.autoRemovedBeforeAppend=!0),s(w,v),v.raycast&&v.__r3f.eventCount&&re(v).getState().internal.interaction.push(v),[p,p.alternate].forEach(i=>{i!==null&&(i.stateNode=v,i.ref&&(typeof i.ref=="function"?i.ref(v):i.ref.current=v))})}const u=()=>{};return{reconciler:pt({createInstance:o,removeChild:g,appendChild:s,appendInitialChild:s,insertBefore:l,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(n,r)=>{if(!r)return;const a=n.getState().scene;a.__r3f&&(a.__r3f.root=n,s(a,r))},removeChildFromContainer:(n,r)=>{r&&g(n.getState().scene,r)},insertInContainerBefore:(n,r,a)=>{if(!r||!a)return;const p=n.getState().scene;p.__r3f&&l(p,r,a)},getRootHostContext:()=>null,getChildHostContext:n=>n,finalizeInitialChildren(n){var r;return!!((r=n==null?void 0:n.__r3f)!=null?r:{}).handlers},prepareUpdate(n,r,a,p){var h;if(((h=n==null?void 0:n.__r3f)!=null?h:{}).primitive&&p.object&&p.object!==n)return[!0];{const{args:v=[],children:i,...f}=p,{args:b=[],children:C,...E}=a;if(!Array.isArray(v))throw new Error("R3F: the args prop must be an array!");if(v.some((R,O)=>R!==b[O]))return[!0];const y=Be(n,f,E,!0);return y.changes.length?[!1,y]:null}},commitUpdate(n,[r,a],p,h,w,v){r?c(n,p,w,v):ue(n,a)},commitMount(n,r,a,p){var h;const w=(h=n.__r3f)!=null?h:{};n.raycast&&w.handlers&&w.eventCount&&re(n).getState().internal.interaction.push(n)},getPublicInstance:n=>n,prepareForCommit:()=>null,preparePortalMount:n=>q(n.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(n){var r;const{attach:a,parent:p}=(r=n.__r3f)!=null?r:{};a&&p&&Re(p,n,a),n.isObject3D&&(n.visible=!1),G(n)},unhideInstance(n,r){var a;const{attach:p,parent:h}=(a=n.__r3f)!=null?a:{};p&&h&&le(h,n,p),(n.isObject3D&&r.visible==null||r.visible)&&(n.visible=!0),G(n)},createTextInstance:u,hideTextInstance:u,unhideTextInstance:u,getCurrentEventPriority:()=>t?t():U.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&x.fun(performance.now)?performance.now:x.fun(Date.now)?Date.now:()=>0,scheduleTimeout:x.fun(setTimeout)?setTimeout:void 0,cancelTimeout:x.fun(clearTimeout)?clearTimeout:void 0}),applyProps:ue}}var Se,Ce;const ce=e=>"colorSpace"in e||"outputColorSpace"in e,Le=()=>{var e;return(e=we.ColorManagement)!=null?e:null},Te=e=>e&&e.isOrthographicCamera,Ct=e=>e&&e.hasOwnProperty("current"),J=typeof window<"u"&&((Se=window.document)!=null&&Se.createElement||((Ce=window.navigator)==null?void 0:Ce.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function Ae(e){const t=S.useRef(e);return J(()=>void(t.current=e),[e]),t}function Pt({set:e}){return J(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class De extends S.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}De.getDerivedStateFromError=()=>({error:!0});const ke="__default",Pe=new Map,Mt=e=>e&&!!e.memoized&&!!e.changes;function ze(e){var t;const o=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],o),e[1]):e}const X=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function re(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const x={obj:e=>e===Object(e)&&!x.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:o="shallow",objects:s="reference",strict:l=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(x.str(e)||x.num(e)||x.boo(e))return e===t;const d=x.obj(e);if(d&&s==="reference")return e===t;const g=x.arr(e);if(g&&o==="reference")return e===t;if((g||d)&&e===t)return!0;let c;for(c in e)if(!(c in t))return!1;if(d&&o==="shallow"&&s==="shallow"){for(c in l?t:e)if(!x.equ(e[c],t[c],{strict:l,objects:"reference"}))return!1}else for(c in l?t:e)if(e[c]!==t[c])return!1;if(x.und(c)){if(g&&e.length===0&&t.length===0||d&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Rt(e){const t={nodes:{},materials:{}};return e&&e.traverse(o=>{o.name&&(t.nodes[o.name]=o),o.material&&!t.materials[o.material.name]&&(t.materials[o.material.name]=o.material)}),t}function xt(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function q(e,t){const o=e;return o.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function he(e,t){let o=e;if(t.includes("-")){const s=t.split("-"),l=s.pop();return o=s.reduce((d,g)=>d[g],e),{target:o,key:l}}else return{target:o,key:t}}const Me=/-\d+$/;function le(e,t,o){if(x.str(o)){if(Me.test(o)){const d=o.replace(Me,""),{target:g,key:c}=he(e,d);Array.isArray(g[c])||(g[c]=[])}const{target:s,key:l}=he(e,o);t.__r3f.previousAttach=s[l],s[l]=t}else t.__r3f.previousAttach=o(e,t)}function Re(e,t,o){var s,l;if(x.str(o)){const{target:d,key:g}=he(e,o),c=t.__r3f.previousAttach;c===void 0?delete d[g]:d[g]=c}else(s=t.__r3f)==null||s.previousAttach==null||s.previousAttach(e,t);(l=t.__r3f)==null||delete l.previousAttach}function Be(e,{children:t,key:o,ref:s,...l},{children:d,key:g,ref:c,...u}={},m=!1){const n=e.__r3f,r=Object.entries(l),a=[];if(m){const h=Object.keys(u);for(let w=0;w<h.length;w++)l.hasOwnProperty(h[w])||r.unshift([h[w],ke+"remove"])}r.forEach(([h,w])=>{var v;if((v=e.__r3f)!=null&&v.primitive&&h==="object"||x.equ(w,u[h]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(h))return a.push([h,w,!0,[]]);let i=[];h.includes("-")&&(i=h.split("-")),a.push([h,w,!1,i]);for(const f in l){const b=l[f];f.startsWith(`${h}-`)&&a.push([f,b,!1,f.split("-")])}});const p={...l};return n!=null&&n.memoizedProps&&n!=null&&n.memoizedProps.args&&(p.args=n.memoizedProps.args),n!=null&&n.memoizedProps&&n!=null&&n.memoizedProps.attach&&(p.attach=n.memoizedProps.attach),{memoized:p,changes:a}}const Ot=typeof process<"u"&&!1;function ue(e,t){var o;const s=e.__r3f,l=s==null?void 0:s.root,d=l==null||l.getState==null?void 0:l.getState(),{memoized:g,changes:c}=Mt(t)?t:Be(e,t),u=s==null?void 0:s.eventCount;e.__r3f&&(e.__r3f.memoizedProps=g);for(let n=0;n<c.length;n++){let[r,a,p,h]=c[n];if(ce(e)){const f="srgb",b="srgb-linear";r==="encoding"?(r="colorSpace",a=a===3001?f:b):r==="outputEncoding"&&(r="outputColorSpace",a=a===3001?f:b)}let w=e,v=w[r];if(h.length&&(v=h.reduce((i,f)=>i[f],e),!(v&&v.set))){const[i,...f]=h.reverse();w=f.reverse().reduce((b,C)=>b[C],e),r=i}if(a===ke+"remove")if(w.constructor){let i=Pe.get(w.constructor);i||(i=new w.constructor,Pe.set(w.constructor,i)),a=i[r]}else a=0;if(p&&s)a?s.handlers[r]=a:delete s.handlers[r],s.eventCount=Object.keys(s.handlers).length;else if(v&&v.set&&(v.copy||v instanceof se)){if(Array.isArray(a))v.fromArray?v.fromArray(a):v.set(...a);else if(v.copy&&a&&a.constructor&&(Ot?v.constructor.name===a.constructor.name:v.constructor===a.constructor))v.copy(a);else if(a!==void 0){const i=v instanceof Je;!i&&v.setScalar?v.setScalar(a):v instanceof se&&a instanceof se?v.mask=a.mask:v.set(a),!Le()&&d&&!d.linear&&i&&v.convertSRGBToLinear()}}else if(w[r]=a,w[r]instanceof $e&&w[r].format===Ve&&w[r].type===Xe&&d){const i=w[r];ce(i)&&ce(d.gl)?i.colorSpace=d.gl.outputColorSpace:i.encoding=d.gl.outputEncoding}G(e)}if(s&&s.parent&&e.raycast&&u!==s.eventCount){const n=re(e).getState().internal,r=n.interaction.indexOf(e);r>-1&&n.interaction.splice(r,1),s.eventCount&&n.interaction.push(e)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(o=e.__r3f)!=null&&o.parent&&ge(e),e}function G(e){var t,o;const s=(t=e.__r3f)==null||(o=t.root)==null||o.getState==null?void 0:o.getState();s&&s.internal.frames===0&&s.invalidate()}function ge(e){e.onUpdate==null||e.onUpdate(e)}function jt(e,t){e.manual||(Te(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function te(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Lt(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return U.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return U.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return U.ContinuousEventPriority;default:return U.DefaultEventPriority}}function He(e,t,o,s){const l=o.get(t);l&&(o.delete(t),o.size===0&&(e.delete(s),l.target.releasePointerCapture(s)))}function Tt(e,t){const{internal:o}=e.getState();o.interaction=o.interaction.filter(s=>s!==t),o.initialHits=o.initialHits.filter(s=>s!==t),o.hovered.forEach((s,l)=>{(s.eventObject===t||s.object===t)&&o.hovered.delete(l)}),o.capturedMap.forEach((s,l)=>{He(o.capturedMap,t,s,l)})}function At(e){function t(u){const{internal:m}=e.getState(),n=u.offsetX-m.initialClick[0],r=u.offsetY-m.initialClick[1];return Math.round(Math.sqrt(n*n+r*r))}function o(u){return u.filter(m=>["Move","Over","Enter","Out","Leave"].some(n=>{var r;return(r=m.__r3f)==null?void 0:r.handlers["onPointer"+n]}))}function s(u,m){const n=e.getState(),r=new Set,a=[],p=m?m(n.internal.interaction):n.internal.interaction;for(let i=0;i<p.length;i++){const f=X(p[i]);f&&(f.raycaster.camera=void 0)}n.previousRoot||n.events.compute==null||n.events.compute(u,n);function h(i){const f=X(i);if(!f||!f.events.enabled||f.raycaster.camera===null)return[];if(f.raycaster.camera===void 0){var b;f.events.compute==null||f.events.compute(u,f,(b=f.previousRoot)==null?void 0:b.getState()),f.raycaster.camera===void 0&&(f.raycaster.camera=null)}return f.raycaster.camera?f.raycaster.intersectObject(i,!0):[]}let w=p.flatMap(h).sort((i,f)=>{const b=X(i.object),C=X(f.object);return!b||!C?i.distance-f.distance:C.events.priority-b.events.priority||i.distance-f.distance}).filter(i=>{const f=te(i);return r.has(f)?!1:(r.add(f),!0)});n.events.filter&&(w=n.events.filter(w,n));for(const i of w){let f=i.object;for(;f;){var v;(v=f.__r3f)!=null&&v.eventCount&&a.push({...i,eventObject:f}),f=f.parent}}if("pointerId"in u&&n.internal.capturedMap.has(u.pointerId))for(let i of n.internal.capturedMap.get(u.pointerId).values())r.has(te(i.intersection))||a.push(i.intersection);return a}function l(u,m,n,r){const a=e.getState();if(u.length){const p={stopped:!1};for(const h of u){const w=X(h.object)||a,{raycaster:v,pointer:i,camera:f,internal:b}=w,C=new K(i.x,i.y,0).unproject(f),E=M=>{var _,j;return(_=(j=b.capturedMap.get(M))==null?void 0:j.has(h.eventObject))!=null?_:!1},y=M=>{const _={intersection:h,target:m.target};b.capturedMap.has(M)?b.capturedMap.get(M).set(h.eventObject,_):b.capturedMap.set(M,new Map([[h.eventObject,_]])),m.target.setPointerCapture(M)},R=M=>{const _=b.capturedMap.get(M);_&&He(b.capturedMap,h.eventObject,_,M)};let O={};for(let M in m){let _=m[M];typeof _!="function"&&(O[M]=_)}let P={...h,...O,pointer:i,intersections:u,stopped:p.stopped,delta:n,unprojectedPoint:C,ray:v.ray,camera:f,stopPropagation(){const M="pointerId"in m&&b.capturedMap.get(m.pointerId);if((!M||M.has(h.eventObject))&&(P.stopped=p.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(_=>_.eventObject===h.eventObject))){const _=u.slice(0,u.indexOf(h));d([..._,h])}},target:{hasPointerCapture:E,setPointerCapture:y,releasePointerCapture:R},currentTarget:{hasPointerCapture:E,setPointerCapture:y,releasePointerCapture:R},nativeEvent:m};if(r(P),p.stopped===!0)break}}return u}function d(u){const{internal:m}=e.getState();for(const n of m.hovered.values())if(!u.length||!u.find(r=>r.object===n.object&&r.index===n.index&&r.instanceId===n.instanceId)){const a=n.eventObject.__r3f,p=a==null?void 0:a.handlers;if(m.hovered.delete(te(n)),a!=null&&a.eventCount){const h={...n,intersections:u};p.onPointerOut==null||p.onPointerOut(h),p.onPointerLeave==null||p.onPointerLeave(h)}}}function g(u,m){for(let n=0;n<m.length;n++){const r=m[n].__r3f;r==null||r.handlers.onPointerMissed==null||r.handlers.onPointerMissed(u)}}function c(u){switch(u){case"onPointerLeave":case"onPointerCancel":return()=>d([]);case"onLostPointerCapture":return m=>{const{internal:n}=e.getState();"pointerId"in m&&n.capturedMap.has(m.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(m.pointerId)&&(n.capturedMap.delete(m.pointerId),d([]))})}}return function(n){const{onPointerMissed:r,internal:a}=e.getState();a.lastEvent.current=n;const p=u==="onPointerMove",h=u==="onClick"||u==="onContextMenu"||u==="onDoubleClick",v=s(n,p?o:void 0),i=h?t(n):0;u==="onPointerDown"&&(a.initialClick=[n.offsetX,n.offsetY],a.initialHits=v.map(b=>b.eventObject)),h&&!v.length&&i<=2&&(g(n,a.interaction),r&&r(n)),p&&d(v);function f(b){const C=b.eventObject,E=C.__r3f,y=E==null?void 0:E.handlers;if(E!=null&&E.eventCount)if(p){if(y.onPointerOver||y.onPointerEnter||y.onPointerOut||y.onPointerLeave){const R=te(b),O=a.hovered.get(R);O?O.stopped&&b.stopPropagation():(a.hovered.set(R,b),y.onPointerOver==null||y.onPointerOver(b),y.onPointerEnter==null||y.onPointerEnter(b))}y.onPointerMove==null||y.onPointerMove(b)}else{const R=y[u];R?(!h||a.initialHits.includes(C))&&(g(n,a.interaction.filter(O=>!a.initialHits.includes(O))),R(b)):h&&a.initialHits.includes(C)&&g(n,a.interaction.filter(O=>!a.initialHits.includes(O)))}}l(v,n,i,f)}}return{handlePointer:c}}const Ie=e=>!!(e!=null&&e.render),Fe=S.createContext(null),Dt=(e,t)=>{const o=_t((c,u)=>{const m=new K,n=new K,r=new K;function a(i=u().camera,f=n,b=u().size){const{width:C,height:E,top:y,left:R}=b,O=C/E;f instanceof K?r.copy(f):r.set(...f);const P=i.getWorldPosition(m).distanceTo(r);if(Te(i))return{width:C/i.zoom,height:E/i.zoom,top:y,left:R,factor:1,distance:P,aspect:O};{const M=i.fov*Math.PI/180,_=2*Math.tan(M/2)*P,j=_*(C/E);return{width:j,height:_,top:y,left:R,factor:C/j,distance:P,aspect:O}}}let p;const h=i=>c(f=>({performance:{...f.performance,current:i}})),w=new ct;return{set:c,get:u,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(i=1)=>e(u(),i),advance:(i,f)=>t(i,f,u()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new lt,pointer:w,mouse:w,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const i=u();p&&clearTimeout(p),i.performance.current!==i.performance.min&&h(i.performance.min),p=setTimeout(()=>h(u().performance.max),i.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:a},setEvents:i=>c(f=>({...f,events:{...f.events,...i}})),setSize:(i,f,b,C,E)=>{const y=u().camera,R={width:i,height:f,top:C||0,left:E||0,updateStyle:b};c(O=>({size:R,viewport:{...O.viewport,...a(y,n,R)}}))},setDpr:i=>c(f=>{const b=ze(i);return{viewport:{...f.viewport,dpr:b,initialDpr:f.viewport.initialDpr||b}}}),setFrameloop:(i="always")=>{const f=u().clock;f.stop(),f.elapsedTime=0,i!=="never"&&(f.start(),f.elapsedTime=0),c(()=>({frameloop:i}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:S.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(i,f,b)=>{const C=u().internal;return C.priority=C.priority+(f>0?1:0),C.subscribers.push({ref:i,priority:f,store:b}),C.subscribers=C.subscribers.sort((E,y)=>E.priority-y.priority),()=>{const E=u().internal;E!=null&&E.subscribers&&(E.priority=E.priority-(f>0?1:0),E.subscribers=E.subscribers.filter(y=>y.ref!==i))}}}}}),s=o.getState();let l=s.size,d=s.viewport.dpr,g=s.camera;return o.subscribe(()=>{const{camera:c,size:u,viewport:m,gl:n,set:r}=o.getState();if(u.width!==l.width||u.height!==l.height||m.dpr!==d){var a;l=u,d=m.dpr,jt(c,u),n.setPixelRatio(m.dpr);const p=(a=u.updateStyle)!=null?a:typeof HTMLCanvasElement<"u"&&n.domElement instanceof HTMLCanvasElement;n.setSize(u.width,u.height,p)}c!==g&&(g=c,r(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(c)}})))}),o.subscribe(c=>e(c)),o};let ne,kt=new Set,zt=new Set,Bt=new Set;function fe(e,t){if(e.size)for(const{callback:o}of e.values())o(t)}function Y(e,t){switch(e){case"before":return fe(kt,t);case"after":return fe(zt,t);case"tail":return fe(Bt,t)}}let de,pe;function ve(e,t,o){let s=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(s=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),de=t.internal.subscribers,ne=0;ne<de.length;ne++)pe=de[ne],pe.ref.current(pe.store.getState(),s,o);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Ht(e){let t=!1,o=!1,s,l,d;function g(m){l=requestAnimationFrame(g),t=!0,s=0,Y("before",m),o=!0;for(const r of e.values()){var n;d=r.store.getState(),d.internal.active&&(d.frameloop==="always"||d.internal.frames>0)&&!((n=d.gl.xr)!=null&&n.isPresenting)&&(s+=ve(m,d))}if(o=!1,Y("after",m),s===0)return Y("tail",m),t=!1,cancelAnimationFrame(l)}function c(m,n=1){var r;if(!m)return e.forEach(a=>c(a.store.getState(),n));(r=m.gl.xr)!=null&&r.isPresenting||!m.internal.active||m.frameloop==="never"||(n>1?m.internal.frames=Math.min(60,m.internal.frames+n):o?m.internal.frames=2:m.internal.frames=1,t||(t=!0,requestAnimationFrame(g)))}function u(m,n=!0,r,a){if(n&&Y("before",m),r)ve(m,r,a);else for(const p of e.values())ve(m,p.store.getState());n&&Y("after",m)}return{loop:g,invalidate:c,advance:u}}function Ne(){const e=S.useContext(Fe);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function H(e=o=>o,t){return Ne()(e,t)}function It(e,t=0){const o=Ne(),s=o.getState().internal.subscribe,l=Ae(e);return J(()=>s(l,t,o),[t,s,o]),null}const xe=new WeakMap;function qe(e,t){return function(o,...s){let l=xe.get(o);return l||(l=new o,xe.set(o,l)),e&&e(l),Promise.all(s.map(d=>new Promise((g,c)=>l.load(d,u=>{u.scene&&Object.assign(u,Rt(u.scene)),g(u)},t,u=>c(new Error(`Could not load ${d}: ${u==null?void 0:u.message}`))))))}}function Ge(e,t,o,s){const l=Array.isArray(t)?t:[t],d=ht(qe(o,s),[e,...l],{equal:x.equ});return Array.isArray(t)?d:d[0]}Ge.preload=function(e,t,o){const s=Array.isArray(t)?t:[t];return gt(qe(o),[e,...s])};Ge.clear=function(e,t){const o=Array.isArray(t)?t:[t];return wt([e,...o])};const W=new Map,{invalidate:Oe,advance:je}=Ht(W),{reconciler:oe,applyProps:F}=St(W,Lt),N={objects:"shallow",strict:!1},Ft=(e,t)=>{const o=typeof e=="function"?e(t):e;return Ie(o)?o:new rt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Nt(e,t){const o=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:s,height:l,top:d,left:g,updateStyle:c=o}=t;return{width:s,height:l,top:d,left:g,updateStyle:c}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:s,height:l,top:d,left:g}=e.parentElement.getBoundingClientRect();return{width:s,height:l,top:d,left:g,updateStyle:o}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:o};return{width:0,height:0,top:0,left:0}}function qt(e){const t=W.get(e),o=t==null?void 0:t.fiber,s=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const l=typeof reportError=="function"?reportError:console.error,d=s||Dt(Oe,je),g=o||oe.createContainer(d,U.ConcurrentRoot,null,!1,null,"",l,null);t||W.set(e,{fiber:g,store:d});let c,u=!1,m;return{configure(n={}){let{gl:r,size:a,scene:p,events:h,onCreated:w,shadows:v=!1,linear:i=!1,flat:f=!1,legacy:b=!1,orthographic:C=!1,frameloop:E="always",dpr:y=[1,2],performance:R,raycaster:O,camera:P,onPointerMissed:M}=n,_=d.getState(),j=_.gl;_.gl||_.set({gl:j=Ft(r,e)});let D=_.raycaster;D||_.set({raycaster:D=new Qe});const{params:$,...Q}=O||{};if(x.equ(Q,D,N)||F(D,{...Q}),x.equ($,D.params,N)||F(D,{params:{...D.params,...$}}),!_.camera||_.camera===m&&!x.equ(m,P,N)){m=P;const A=P instanceof ot,L=A?P:C?new Ze(0,0,0,0,.1,1e3):new et(75,0,.1,1e3);A||(L.position.z=5,P&&(F(L,P),("aspect"in P||"left"in P||"right"in P||"bottom"in P||"top"in P)&&(L.manual=!0,L.updateProjectionMatrix())),!_.camera&&!(P!=null&&P.rotation)&&L.lookAt(0,0,0)),_.set({camera:L}),D.camera=L}if(!_.scene){let A;p instanceof be?A=p:(A=new be,p&&F(A,p)),_.set({scene:q(A)})}if(!_.xr){var V;const A=(T,ie)=>{const ee=d.getState();ee.frameloop!=="never"&&je(T,!0,ee,ie)},L=()=>{const T=d.getState();T.gl.xr.enabled=T.gl.xr.isPresenting,T.gl.xr.setAnimationLoop(T.gl.xr.isPresenting?A:null),T.gl.xr.isPresenting||Oe(T)},I={connect(){const T=d.getState().gl;T.xr.addEventListener("sessionstart",L),T.xr.addEventListener("sessionend",L)},disconnect(){const T=d.getState().gl;T.xr.removeEventListener("sessionstart",L),T.xr.removeEventListener("sessionend",L)}};typeof((V=j.xr)==null?void 0:V.addEventListener)=="function"&&I.connect(),_.set({xr:I})}if(j.shadowMap){const A=j.shadowMap.enabled,L=j.shadowMap.type;if(j.shadowMap.enabled=!!v,x.boo(v))j.shadowMap.type=ae;else if(x.str(v)){var Z;const I={basic:it,percentage:st,soft:ae,variance:at};j.shadowMap.type=(Z=I[v])!=null?Z:ae}else x.obj(v)&&Object.assign(j.shadowMap,v);(A!==j.shadowMap.enabled||L!==j.shadowMap.type)&&(j.shadowMap.needsUpdate=!0)}const z=Le();z&&("enabled"in z?z.enabled=!b:"legacyMode"in z&&(z.legacyMode=b)),u||F(j,{outputEncoding:i?3e3:3001,toneMapping:f?tt:nt}),_.legacy!==b&&_.set(()=>({legacy:b})),_.linear!==i&&_.set(()=>({linear:i})),_.flat!==f&&_.set(()=>({flat:f})),r&&!x.fun(r)&&!Ie(r)&&!x.equ(r,j,N)&&F(j,r),h&&!_.events.handlers&&_.set({events:h(d)});const B=Nt(e,a);return x.equ(B,_.size,N)||_.setSize(B.width,B.height,B.updateStyle,B.top,B.left),y&&_.viewport.dpr!==ze(y)&&_.setDpr(y),_.frameloop!==E&&_.setFrameloop(E),_.onPointerMissed||_.set({onPointerMissed:M}),R&&!x.equ(R,_.performance,N)&&_.set(A=>({performance:{...A.performance,...R}})),c=w,u=!0,this},render(n){return u||this.configure(),oe.updateContainer(k.jsx(Gt,{store:d,children:n,onCreated:c,rootElement:e}),g,null,()=>{}),d},unmount(){Ue(e)}}}function Gt({store:e,children:t,onCreated:o,rootElement:s}){return J(()=>{const l=e.getState();l.set(d=>({internal:{...d.internal,active:!0}})),o&&o(l),e.getState().events.connected||l.events.connect==null||l.events.connect(s)},[]),k.jsx(Fe.Provider,{value:e,children:t})}function Ue(e,t){const o=W.get(e),s=o==null?void 0:o.fiber;if(s){const l=o==null?void 0:o.store.getState();l&&(l.internal.active=!1),oe.updateContainer(null,s,null,()=>{l&&setTimeout(()=>{try{var d,g,c,u;l.events.disconnect==null||l.events.disconnect(),(d=l.gl)==null||(g=d.renderLists)==null||g.dispose==null||g.dispose(),(c=l.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(u=l.gl)!=null&&u.xr&&l.xr.disconnect(),xt(l),W.delete(e)}catch{}},500)})}}oe.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:S.version});const me={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Ut(e){const{handlePointer:t}=At(e);return{priority:1,enabled:!0,compute(o,s,l){s.pointer.set(o.offsetX/s.size.width*2-1,-(o.offsetY/s.size.height)*2+1),s.raycaster.setFromCamera(s.pointer,s.camera)},connected:void 0,handlers:Object.keys(me).reduce((o,s)=>({...o,[s]:t(s)}),{}),update:()=>{var o;const{events:s,internal:l}=e.getState();(o=l.lastEvent)!=null&&o.current&&s.handlers&&s.handlers.onPointerMove(l.lastEvent.current)},connect:o=>{var s;const{set:l,events:d}=e.getState();d.disconnect==null||d.disconnect(),l(g=>({events:{...g.events,connected:o}})),Object.entries((s=d.handlers)!=null?s:[]).forEach(([g,c])=>{const[u,m]=me[g];o.addEventListener(u,c,{passive:m})})},disconnect:()=>{const{set:o,events:s}=e.getState();if(s.connected){var l;Object.entries((l=s.handlers)!=null?l:[]).forEach(([d,g])=>{if(s&&s.connected instanceof HTMLElement){const[c]=me[d];s.connected.removeEventListener(c,g)}}),o(d=>({events:{...d.events,connected:void 0}}))}}}}function Wt({debounce:e,scroll:t,polyfill:o,offsetSize:s}={debounce:0,scroll:!1,offsetSize:!1}){const l=o||typeof window<"u"&&window.ResizeObserver,[d,g]=S.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!l)return d.width=1280,d.height=800,[()=>{},d,()=>{}];const c=S.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d,orientationHandler:null}),u=e?typeof e=="number"?e:e.scroll:null,m=e?typeof e=="number"?e:e.resize:null,n=S.useRef(!1);S.useEffect(()=>(n.current=!0,()=>void(n.current=!1)));const[r,a,p]=S.useMemo(()=>{const i=()=>{if(!c.current.element)return;const{left:f,top:b,width:C,height:E,bottom:y,right:R,x:O,y:P}=c.current.element.getBoundingClientRect(),M={left:f,top:b,width:C,height:E,bottom:y,right:R,x:O,y:P};c.current.element instanceof HTMLElement&&s&&(M.height=c.current.element.offsetHeight,M.width=c.current.element.offsetWidth),Object.freeze(M),n.current&&!Yt(c.current.lastBounds,M)&&g(c.current.lastBounds=M)};return[i,m?ye(i,m):i,u?ye(i,u):i]},[g,s,u,m]);function h(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(i=>i.removeEventListener("scroll",p,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function w(){var i;c.current.element&&(c.current.resizeObserver=new l(a),(i=c.current.resizeObserver)==null||i.observe(c.current.element),t&&c.current.scrollContainers&&c.current.scrollContainers.forEach(f=>f.addEventListener("scroll",p,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const v=i=>{!i||i===c.current.element||(h(),c.current.element=i,c.current.scrollContainers=We(i),w())};return Vt(p,!!t),$t(a),S.useEffect(()=>{h(),w()},[t,p,a]),S.useEffect(()=>h,[]),[v,d,r]}function $t(e){S.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function Vt(e,t){S.useEffect(()=>{if(t){const o=e;return window.addEventListener("scroll",o,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",o,!0)}},[e,t])}function We(e){const t=[];if(!e||e===document.body)return t;const{overflow:o,overflowX:s,overflowY:l}=window.getComputedStyle(e);return[o,s,l].some(d=>d==="auto"||d==="scroll")&&t.push(e),[...t,...We(e.parentElement)]}const Xt=["x","y","top","bottom","left","right","width","height"],Yt=(e,t)=>Xt.every(o=>e[o]===t[o]),Kt=S.forwardRef(function({children:t,fallback:o,resize:s,style:l,gl:d,events:g=Ut,eventSource:c,eventPrefix:u,shadows:m,linear:n,flat:r,legacy:a,orthographic:p,frameloop:h,dpr:w,performance:v,raycaster:i,camera:f,scene:b,onPointerMissed:C,onCreated:E,...y},R){S.useMemo(()=>Et(ut),[]);const O=dt(),[P,M]=Wt({scroll:!0,debounce:{scroll:50,resize:0},...s}),_=S.useRef(null),j=S.useRef(null);S.useImperativeHandle(R,()=>_.current);const D=Ae(C),[$,Q]=S.useState(!1),[V,Z]=S.useState(!1);if($)throw $;if(V)throw V;const z=S.useRef(null);J(()=>{const A=_.current;M.width>0&&M.height>0&&A&&(z.current||(z.current=qt(A)),z.current.configure({gl:d,events:g,shadows:m,linear:n,flat:r,legacy:a,orthographic:p,frameloop:h,dpr:w,performance:v,raycaster:i,camera:f,scene:b,size:M,onPointerMissed:(...L)=>D.current==null?void 0:D.current(...L),onCreated:L=>{L.events.connect==null||L.events.connect(c?Ct(c)?c.current:c:j.current),u&&L.setEvents({compute:(I,T)=>{const ie=I[u+"X"],ee=I[u+"Y"];T.pointer.set(ie/T.size.width*2-1,-(ee/T.size.height)*2+1),T.raycaster.setFromCamera(T.pointer,T.camera)}}),E==null||E(L)}}),z.current.render(k.jsx(O,{children:k.jsx(De,{set:Z,children:k.jsx(S.Suspense,{fallback:k.jsx(Pt,{set:Q}),children:t})})})))}),S.useEffect(()=>{const A=_.current;if(A)return()=>Ue(A)},[]);const B=c?"none":"auto";return k.jsx("div",{ref:j,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...l},...y,children:k.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:k.jsx("canvas",{ref:_,style:{display:"block"},children:o})})})}),cn=S.forwardRef(function(t,o){return k.jsx(ft,{children:k.jsx(Kt,{...t,ref:o})})}),ln=S.forwardRef(({makeDefault:e,camera:t,regress:o,domElement:s,enableDamping:l=!0,keyEvents:d=!1,onChange:g,onStart:c,onEnd:u,...m},n)=>{const r=H(y=>y.invalidate),a=H(y=>y.camera),p=H(y=>y.gl),h=H(y=>y.events),w=H(y=>y.setEvents),v=H(y=>y.set),i=H(y=>y.get),f=H(y=>y.performance),b=t||a,C=s||h.connected||p.domElement,E=S.useMemo(()=>new mt(b),[b]);return It(()=>{E.enabled&&E.update()},-1),S.useEffect(()=>(d&&E.connect(d===!0?C:d),E.connect(C),()=>void E.dispose()),[d,C,o,E,r]),S.useEffect(()=>{const y=P=>{r(),o&&f.regress(),g&&g(P)},R=P=>{c&&c(P)},O=P=>{u&&u(P)};return E.addEventListener("change",y),E.addEventListener("start",R),E.addEventListener("end",O),()=>{E.removeEventListener("start",R),E.removeEventListener("end",O),E.removeEventListener("change",y)}},[g,c,u,E,r,w]),S.useEffect(()=>{if(e){const y=i().controls;return v({controls:E}),()=>v({controls:y})}},[e,E]),S.createElement("primitive",vt({ref:n,object:E,enableDamping:l},m))});export{cn as C,ln as O,Ge as u};
